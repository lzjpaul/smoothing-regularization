this uses regularization grad each step
