first version, both features and weights are sparse
